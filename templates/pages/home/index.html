<div class="cover-container">
  <div class="cover">
    <div class="text-container">
      <div style="height: 100px"></div>
      <div class="intro">
        <span class="animate" id="intro1">We</span>
        <span class="animate" id="intro2">are</span>
        <span class="animate" id="intro3">CSM</span>
      </div>
      <div class="animate subintro">Computer Science Mentors for introductory computer science courses at UC Berkeley</div>
      <div style="height: 100px"></div>
      <div class="row courses">
        <div class="col s12 m3">
          <h4 class="animate" id="course1">CS 61A</h4>
        </div>
        <div class="col s12 m3">
          <h4 class="animate" id="course2">CS 61B</h4>
        </div>
        <div class="col s12 m3">
          <h4 class="animate" id="course3">CS 70</h4>
        </div>
        <div class="col s12 m3">
          <h4 class="animate" id="course4">EE 16A</h4>
        </div>
      </div>

      <div class="stats">
        <h5 class="white-text"><span id="student-count">1100</span>+ Students Serviced</h5>
        <h5 class="white-text"><span id="mentor-count">200</span>+ Mentors</h5>
        <h5 class="white-text">Average mentor rating: <span id="rating-count">4.6</span> / 5</h5>
        <h5 class="white-text"><span id="return-count">93</span>% would come back to a CSM session</h5>
      </div>

    </div>
  </div>
  <div class="cover-img"></div>
  <div class="cover-darken"></div>
</div>

<section class="three-column">
  <div class="container">
    <div class="row">
      <div class="col m6">
        <h5 class="label">What is CSM</h5>
        <p class="info">
          CSM is a student-run organization that provides guidance and resources in a smaller classroom environment through group tutoring sessions. Each section has 4-6 students and focuses on material from one of the courses listed above. Outside of teaching, our mentors watch movies, climb up to Soda almost everyday, hike, study together, and more!
        </p>
      </div>
      <div class="col m6">
        <h5 class="label">Who we are</h5>
        <p class="info">
          We are a group of UC Berkeley students passionate about teaching and helping students succeed in computer science. CSM provides a tiered system of mentoring opportunities. <b>Senior Mentors</b> write material and provide tips to <b>Junior Mentors</b> on how to teach. All mentors meet up once a week to learn from each other, and use another time of the week to teach a section. Our <b>Associate Mentors</b> are either tutors, readers, or other experienced teachers who teach a section without a Senior Mentor.
        </p>
      </div>
    </div>
    <br>
    <div class="row center">
      <div class="col m4 s10 offset-s1">
      <h5>Plan to join a section?</h5>
        <a class="waves-effect waves-light green lighten-1 btn" href="#/students">Join</a>
      </div>
      <div class="col m4 s10 offset-s1">
      <h5>Want to be a mentor?</h5>
        <a class="waves-effect waves-light green lighten-1 btn" href="#/mentors">Apply</a>
      </div>
      <div class="col m4 s10 offset-s1">
      <h5>Want to work with us?</h5>
        <a class="waves-effect waves-light green lighten-1 btn" href="#/partners">Partner</a>
      </div>
    </div>
    <div class="row">
      <a class="waves-effect waves-light btn" href="https://www.facebook.com/BerkeleyCSM/">Give our Facebook page a like for updates and events!</a>
    </div>
  </div>
</section>

<script>
  var timeout = 0;
  var animations = ['.stats'];

  // Fire the onload animation, setup the timeout for the next animation, and register it to list
  function loadNext(className, delay) {
    timeout += delay;
    animations.push(className);
    setTimeout(function() {
      $(className).addClass('onload');
    }, timeout)
  }

  function updateCover() {
    $coverImage = $('.cover-img');
    console.log($coverImage.offset().top);
    console.log($coverImage.outerHeight());
    $('.cover-darken').css({'top': $coverImage.position().top, 'height': $coverImage.height()});
  }

  const options = {
      useEasing : true,
      useGrouping : true,
      separator : ',',
      decimal : '.',
      prefix : '',
      suffix : ''
  };
  var counted = false;

  function showStats() {
    if (counted) {
      return;
    }
    $('.stats').addClass('onload');
    (new CountUp('student-count', 0, 1100, 0, 3, options)).start();
    (new CountUp('mentor-count', 0, 120, 0, 3, options)).start();
    (new CountUp('rating-count', 0, 4.6, 1, 3, options)).start();
    (new CountUp('return-count', 0, 93, 0, 3, options)).start();
    counted = true;
  }

  $(function() {
    $(window).on('scroll', function() {
      var y_scroll_pos = window.pageYOffset;
      var scroll_pos_test = 150;             // set to whatever you want it to be

      if(y_scroll_pos > scroll_pos_test) {
        showStats();
      }
    });

    $('.cover').click(function() {
      animations.forEach(function(a) {
        $(a).css('transition', 'none');
        $(a).addClass('onload');
      });
      $(this).css('cursor', 'auto');
      showStats();
    });

    loadNext('#intro1', 0);
    loadNext('#intro2', 500);
    loadNext('#intro3', 500);
    loadNext('.cover-darken', 0);
    loadNext('.subintro', 500);
    loadNext('#course1', 500);
    loadNext('#course2', 250);
    loadNext('#course3', 250);
    loadNext('#course4', 250);
    setTimeout(showStats, timeout + 800);
  });
</script>
